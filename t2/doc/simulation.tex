\section{Simulation}
\label{sec:simulation}
In this circuit, we have a current dependent voltage source between nodes 5 and 8, so that, to sense the controlling current, $I_d$, between nodes GND and 7, we need to use a voltage source of voltage 0V, to sense said current. For this purpose, we placed this source between node 7 and a new node - node 9-, which connects the negative terminal of the voltage source and resistor 7, so that it is in series with resistor 6, through which $I_d$ flows, and therefore senses that same current.\\
\subsection{Operating Point Analysis for t\textless0}
To simulate the response of the circuit for t\textless0, where the voltage source introduces to the circuit a constant voltage, $V_s$, the current through the capacitor is zero, so there is an open circuit between nodes 6 and 8. The results of the operating point analysis for this circuit, t\textless0, obtained using \textit{ngspice}, can be seen in Table ~\ref{tab:op}.\\

\subsection{Operating Point Analysis for t=0}
To get the operating point analysis for t=0, knowing $v_s(0)=0$, we substitute the capacitor, between nodes 6 and 8, with a voltage source $V_x=V_6-V_8$, where $V_6$ and $V_8$ are the voltage for nodes 6 and 8, respectively, obtained in the previous op analysis (for t\textless0). This is needed so continuity of voltage in the capacitor is guaranteed and so we can use the voltages obtained with this analysis as initial conditions in the following sections. The results of this analysis, using \textit{ngspice} can be seen in Table ~\ref{tab:ops}.\\
\subsection{Transient Analysis for Natural Response}
From now on, we have the capacitor in its place, between nodes 6 and 8.\\
To simulate the natural response of the circuit, the source $V_s$ was turned off (the voltage has to be 0V to get the natural response), and we used boundary conditions of $V_6$ and $V_8$(voltages in nodes 6 and 8), as the values obtained in t=0. These conditions will also be used in the latter sections. We did transient analysis, for the [0,20]ms time interval, with a 0.02ms time step. The plot of $v_{6}(t)$ is shown in Figure ~\ref{fig:rc2}.\\
\subsection{Analysis of Total Response}
For this section, we now have $V_s$ as a sine wave of frequency f=1k Hz, and amplitude 1 ($V_s=sin(2\pi f t)$). A transient analysis was done, for nodes 6 (V6) and 1 (Vs),again for the [0,20]ms time period with a 0.02ms time step. We can then see the results of the voltage introduced to the circuit (Vs) and the total response on node 6, from both this stimulus from Vs and the natural response of the system. This can be seen in Figure ~\ref{fig:bb}.\\
\subsection{Frequency Analysis}
To evaluate the circuit when the frequency changes, we used ac analysis, by decades - using a frequency logscale. Frequencies were considered from 0.1 Hz to 1MHz and we used 100 points to plot both the magnitude and phase of voltages of nodes 1, 6 and of the capacitor $v_c$, which corresponds to $V_6 - V_8$, as functions of frequency. The magnitude plot can be seen in Figure ~\ref{fig:dd}, and the phase plot in Figure ~\ref{fig:ff}.\\
